doctype html
head
  link(rel="stylesheet" type="text/css" href="/style.css")
  script var model = !{JSON.stringify(model)}
  script(src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous")
  meta(name="viewport" content="width=device-width, initial-scale=1")
  link(rel="icon" type="image/png" href="/dp-cool-128.png")
  title Self Tracker
body
  -
    const renderInput = activity => {
      const cell = cells[activity.col] || {}
      switch(activity.type) {
        case 'bool':
          return `
            <div class="radios" data-col="${activity.col}" data-type="bool">
              <label>
                <input type="radio" value="1" name="bool-${activity.col}" ${cell.value === "1" ? 'checked' : ''} />
                <span>Yes</span>
              </label>
              <label>
                <input type="radio" value="0" name="bool-${activity.col}" ${cell.value === "0" ? 'checked' : ''} />
                <span>No</span>
              </label>
            </div>
          `
        case 'time':
          const apZr = val => (val < 10 ? '0' : '') + val
          const hour = apZr(parseInt(cell.numericValue * 24))
          const minute = apZr(Math.round((cell.numericValue * 24) % 1 * 60))
          return `<input type="time" ${cell.value ? `value="${hour}:${minute}"` : ''} data-col="${activity.col}" />`

        default:
          return '---'
      }
    }

  #main(data-row=cells.row)
    h1 Track it Brah!!!
    h3= date.format('ll')
    table
      each activity in (model.values || [])
        tr.activity
          td.name= activity.name
          if !activity.children
            td!= renderInput(activity)
          else
            td
        if activity.children
          each child in activity.children
            tr.child
              td.name= child.name
              td!= renderInput(child)
    button.save Save

  script(src="/script.js")
